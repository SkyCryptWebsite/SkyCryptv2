import type { StatsData } from "$types/processed/profile/stats";

export const STATS_DATA: StatsData = {
  health: {
    name: "Health",
    nameLore: "Health",
    nameShort: "Health",
    nameTiny: "HP",
    symbol: "‚ù§",
    suffix: "",
    color: "text-minecraft-c"
  },
  defense: {
    name: "Defense",
    nameLore: "Defense",
    nameShort: "Defense",
    nameTiny: "Def",
    symbol: "‚ùà",
    suffix: "",
    color: "text-minecraft-a"
  },
  strength: {
    name: "Strength",
    nameLore: "Strength",
    nameShort: "Strength",
    nameTiny: "Str",
    symbol: "‚ùÅ",
    suffix: "",
    color: "text-minecraft-c"
  },
  speed: {
    name: "Speed",
    nameLore: "Speed",
    nameShort: "Speed",
    nameTiny: "Spd",
    symbol: "‚ú¶",
    suffix: "",
    color: "text-minecraft-f"
  },
  critical_chance: {
    name: "Crit Chance",
    nameLore: "Crit Chance",
    nameShort: "Crit Chance",
    nameTiny: "CC",
    symbol: "‚ò£",
    suffix: "%",
    color: "text-minecraft-9",
    percent: true
  },
  critical_damage: {
    name: "Crit Damage",
    nameLore: "Crit Damage",
    nameShort: "Crit Damage",
    nameTiny: "CD",
    symbol: "‚ò†",
    suffix: "%",
    color: "text-minecraft-9",
    percent: true
  },
  intelligence: {
    name: "Intelligence",
    nameLore: "Intelligence",
    nameShort: "Intelligence",
    nameTiny: "Int",
    symbol: "‚úé",
    suffix: "",
    color: "text-minecraft-b"
  },
  bonus_attack_speed: {
    name: "Bonus Attack Speed",
    nameLore: "Bonus Attack Speed",
    nameShort: "Attack Speed",
    nameTiny: "Atk",
    symbol: "‚öî",
    suffix: "%",
    color: "text-minecraft-e",
    percent: true
  },
  sea_creature_chance: {
    name: "Sea Creature Chance",
    nameLore: "Sea Creature Chance",
    nameShort: "SC Chance",
    nameTiny: "SCC",
    symbol: "Œ±",
    suffix: "%",
    color: "text-minecraft-3",
    percent: true
  },
  magic_find: {
    name: "Magic Find",
    nameLore: "Magic Find",
    nameShort: "Magic Find",
    nameTiny: "MF",
    symbol: "‚úØ",
    suffix: "",
    color: "text-minecraft-b"
  },
  pet_luck: {
    name: "Pet Luck",
    nameLore: "Pet Luck",
    nameShort: "Pet Luck",
    nameTiny: "PL",
    symbol: "‚ô£",
    suffix: "",
    color: "text-minecraft-d"
  },
  true_defense: {
    name: "True Defense",
    nameLore: "True Defense",
    nameShort: "True Defense",
    nameTiny: "TD",
    symbol: "‚ùÇ",
    suffix: "",
    color: "text-minecraft-f"
  },
  ferocity: {
    name: "Ferocity",
    nameLore: "Ferocity",
    nameShort: "Ferocity",
    nameTiny: "Frc",
    symbol: "‚´Ω",
    suffix: "",
    color: "text-minecraft-c"
  },
  ability_damage: {
    name: "Ability Damage",
    nameLore: "Ability Damage",
    nameShort: "Ability Damage",
    nameTiny: "AD",
    symbol: "‡πë",
    suffix: "%",
    color: "text-minecraft-c",
    percent: true
  },
  mining_speed: {
    name: "Mining Speed",
    nameLore: "Mining Speed",
    nameShort: "Mining Speed",
    nameTiny: "MngSpd",
    symbol: "‚∏ï",
    suffix: "",
    color: "text-minecraft-6"
  },
  mining_fortune: {
    name: "Mining Fortune",
    nameLore: "Mining Fortune",
    nameShort: "Mining Fortune",
    nameTiny: "MngFrt",
    symbol: "‚òò",
    suffix: "",
    color: "text-minecraft-6"
  },
  ore_fortune: {
    name: "Ore Fortune",
    nameLore: "Ore Fortune",
    nameShort: "Ore Fortune",
    nameTiny: "OreFrt",
    symbol: "‚òò",
    suffix: "",
    color: "text-minecraft-6"
  },
  farming_fortune: {
    name: "Farming Fortune",
    nameLore: "Farming Fortune",
    nameShort: "Farming Fortune",
    nameTiny: "FrmFrt",
    symbol: "‚òò",
    suffix: "",
    color: "text-minecraft-6"
  },
  foraging_fortune: {
    name: "Foraging Fortune",
    nameLore: "Foraging Fortune",
    nameShort: "Foraging Fortune",
    nameTiny: "FrgFrt",
    symbol: "‚òò",
    suffix: "",
    color: "text-minecraft-6"
  },
  pristine: {
    name: "Pristine",
    nameLore: "Pristine",
    nameShort: "Pristine",
    nameTiny: "Prs",
    symbol: "‚úß",
    suffix: "",
    color: "text-minecraft-5"
  },
  fishing_speed: {
    name: "Fishing Speed",
    nameLore: "Fishing Speed",
    nameShort: "Fishing Speed",
    nameTiny: "FS",
    symbol: "‚òÇ",
    suffix: "",
    color: "text-minecraft-b"
  },
  breaking_power: {
    name: "Breaking Power",
    nameLore: "Breaking Power",
    nameShort: "Breaking Power",
    nameTiny: "BP",
    symbol: "‚ìÖ",
    suffix: "",
    color: "text-minecraft-2"
  },
  health_regen: {
    name: "Health Regen",
    nameLore: "Health Regen",
    nameShort: "Health Regen",
    nameTiny: "HPR",
    symbol: "‚ù£",
    suffix: "",
    color: "text-minecraft-c"
  },
  vitality: {
    name: "Vitality",
    nameLore: "Vitality",
    nameShort: "Vitality",
    nameTiny: "Vit",
    symbol: "‚ô®",
    suffix: "",
    color: "text-minecraft-5"
  },
  mending: {
    name: "Mending",
    nameLore: "Mending",
    nameShort: "Mending",
    nameTiny: "Mend",
    symbol: "‚òÑ",
    suffix: "",
    color: "text-minecraft-a"
  },
  mana_regen: {
    name: "Mana Regen",
    nameLore: "Mana Regen",
    nameShort: "Mana Regen",
    nameTiny: "MPR",
    symbol: "üó≤",
    suffix: "",
    color: "text-minecraft-b"
  },
  rift_time: {
    name: "Rift Time",
    nameLore: "Rift Time",
    nameShort: "Rift Time",
    nameTiny: "RT",
    symbol: "—Ñ",
    suffix: "",
    color: "text-minecraft-a"
  },
  alchemy_wisdom: {
    name: "Alchemy Wisdom",
    nameLore: "Alchemy Wisdom",
    nameShort: "Alchemy Wisdom",
    nameTiny: "AW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  carpentry_wisdom: {
    name: "Carpentry Wisdom",
    nameLore: "Carpentry Wisdom",
    nameShort: "Carpentry Wisdom",
    nameTiny: "CW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  combat_wisdom: {
    name: "Combat Wisdom",
    nameLore: "Combat Wisdom",
    nameShort: "Combat Wisdom",
    nameTiny: "CW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  enchanting_wisdom: {
    name: "Enchanting Wisdom",
    nameLore: "Enchanting Wisdom",
    nameShort: "Enchanting Wisdom",
    nameTiny: "EW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  farming_wisdom: {
    name: "Farming Wisdom",
    nameLore: "Farming Wisdom",
    nameShort: "Farming Wisdom",
    nameTiny: "FW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  fishing_wisdom: {
    name: "Fishing Wisdom",
    nameLore: "Fishing Wisdom",
    nameShort: "Fishing Wisdom",
    nameTiny: "FW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  foraging_wisdom: {
    name: "Foraging Wisdom",
    nameLore: "Foraging Wisdom",
    nameShort: "Foraging Wisdom",
    nameTiny: "FW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  mining_wisdom: {
    name: "Mining Wisdom",
    nameLore: "Mining Wisdom",
    nameShort: "Mining Wisdom",
    nameTiny: "MW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  runecrafting_wisdom: {
    name: "Runecrafting Wisdom",
    nameLore: "Runecrafting Wisdom",
    nameShort: "Runecrafting Wisdom",
    nameTiny: "RW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  social_wisdom: {
    name: "Social Wisdom",
    nameLore: "Social Wisdom",
    nameShort: "Social Wisdom",
    nameTiny: "SW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  taming_wisdom: {
    name: "Taming Wisdom",
    nameLore: "Taming Wisdom",
    nameShort: "Taming Wisdom",
    nameTiny: "TW",
    symbol: "‚òØ",
    suffix: "",
    color: "text-minecraft-3"
  },
  bonus_pest_chance: {
    name: "Bonus Pest Chance",
    nameLore: "Bonus Pest Chance",
    nameShort: "Bonus Pest Chance",
    nameTiny: "BPC",
    symbol: "‡µ†",
    suffix: "",
    color: "text-minecraft-2"
  },
  swing_range: {
    name: "Swing Range",
    nameLore: "Swing Range",
    nameShort: "Swing Range",
    nameTiny: "SR",
    symbol: "‚ìà",
    suffix: "",
    color: "text-minecraft-e"
  },
  cold_resistance: {
    name: "Cold Resistance",
    nameLore: "Cold Resistance",
    nameShort: "Cold Resistance",
    nameTiny: "CRes",
    symbol: "‚ùÑ",
    suffix: "",
    color: "text-minecraft-b"
  },
  mining_spread: {
    name: "Mining Spread",
    nameLore: "Mining Spread",
    nameTiny: "MS",
    symbol: "‚ñö",
    color: "text-minecraft-e"
  },
  gemstone_spread: {
    name: "Gemstone Spread",
    nameLore: "Gemstone Spread",
    nameTiny: "GS",
    symbol: "‚ñö",
    color: "text-minecraft-e"
  },
  block_fortune: {
    name: "Block Fortune",
    nameLore: "Block Fortune",
    nameTiny: "BFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  dwarven_metal_fortune: {
    name: "Dwarven Metal Fortune",
    nameLore: "Dwarven Metal Fortune",
    nameTiny: "DMFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  gemstone_fortune: {
    name: "Gemstone Fortune",
    nameLore: "Gemstone Fortune",
    nameTiny: "GFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  wheat_fortune: {
    name: "Wheat Fortune",
    nameLore: "Wheat Fortune",
    nameTiny: "WFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  carrot_fortune: {
    name: "Carrot Fortune",
    nameLore: "Carrot Fortune",
    nameTiny: "CFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  potato_fortune: {
    name: "Potato Fortune",
    nameLore: "Potato Fortune",
    nameTiny: "PFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  pumpkin_fortune: {
    name: "Pumpkin Fortune",
    nameLore: "Pumpkin Fortune",
    nameTiny: "PkFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  melon_fortune: {
    name: "Melon Fortune",
    nameLore: "Melon Fortune",
    nameTiny: "MFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  mushroom_fortune: {
    name: "Mushroom Fortune",
    nameLore: "Mushroom Fortune",
    nameTiny: "MsFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  cactus_fortune: {
    name: "Cactus Fortune",
    nameLore: "Cactus Fortune",
    nameTiny: "CFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  sugar_cane_fortune: {
    name: "Sugar Cane Fortune",
    nameLore: "Sugar Cane Fortune",
    nameTiny: "SCFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  nether_wart_fortune: {
    name: "Nether Wart Fortune",
    nameLore: "Nether Wart Fortune",
    nameTiny: "NWFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  cocoa_beans_fortune: {
    name: "Cocoa Beans Fortune",
    nameLore: "Cocoa Beans Fortune",
    nameTiny: "CBFrt",
    symbol: "‚òò",
    color: "text-minecraft-6"
  },
  double_hook_chance: {
    name: "Double Hook Chance",
    nameLore: "Double Hook Chance",
    nameTiny: "DHC",
    symbol: "‚öì",
    color: "text-minecraft-9"
  },
  trophy_fish_chance: {
    name: "Trophy Fish Chance",
    nameLore: "Trophy Fish Chance",
    nameTiny: "TFC",
    symbol: "‚ôî",
    color: "text-minecraft-6"
  },
  heat_resistance: {
    name: "Heat Resistance",
    nameLore: "Heat Resistance",
    nameTiny: "HRes",
    symbol: "‚ô®",
    color: "text-minecraft-c"
  },
  fear: {
    name: "Fear",
    nameLore: "Fear",
    nameTiny: "Fr",
    symbol: "‚ò†",
    color: "text-minecraft-5"
  }
};

export const STAT_ALIASES = {
  crit_damage: "critical_damage",
  crit_chance: "critical_chance"
} as Record<string, string>;

export const STATS_BONUS = {
  // Skills
  skill_farming: {
    1: { health: 2, farming_fortune: 4 },
    15: { health: 3, farming_fortune: 4 },
    20: { health: 4, farming_fortune: 4 },
    26: { health: 5, farming_fortune: 4 }
  },
  skill_mining: {
    1: { defense: 1, mining_fortune: 4 },
    15: { defense: 2, mining_fortune: 4 }
  },
  skill_combat: {
    1: { critical_chance: 0.5 }
  },
  skill_foraging: {
    1: { strength: 1, foraging_fortune: 4 },
    15: { strength: 2, foraging_fortune: 4 }
  },
  skill_fishing: {
    1: { health: 2 },
    15: { health: 3 },
    20: { health: 4 },
    26: { health: 5 }
  },
  skill_enchanting: {
    1: { intelligence: 1, ability_damage: 0.5 },
    15: { intelligence: 2, ability_damage: 0.5 }
  },
  skill_alchemy: {
    1: { intelligence: 1 },
    15: { intelligence: 2 }
  },
  skill_taming: {
    1: { pet_luck: 1 }
  },
  skill_dungeoneering: {
    1: { health: 2 },
    51: { health: 0 }
  },
  skill_social: {},
  skill_carpentry: {
    1: { health: 1 }
  },
  skill_runecrafting: {},
  // Slayers
  slayer_zombie: {
    1: { health: 2 },
    3: { health: 3 },
    5: { health: 4 },
    7: { health: 5 },
    8: { health: 5, health_regen: 50 },
    9: { health: 6 }
  },
  slayer_spider: {
    1: { critical_damage: 1 },
    5: { critical_damage: 2 },
    7: { critical_damage: 2 },
    8: { critical_damage: 3 }
  },
  slayer_wolf: {
    1: { speed: 1 },
    2: { health: 2 },
    3: { speed: 1 },
    4: { health: 2 },
    5: { critical_damage: 1 },
    6: { health: 3 },
    7: { critical_damage: 2 },
    8: { speed: 1 },
    9: { health: 5 }
  },
  slayer_enderman: {
    1: { health: 1 },
    2: { intelligence: 2 },
    3: { health: 2 },
    4: { intelligence: 2 },
    5: { health: 3 },
    6: { intelligence: 5 },
    7: { health: 4 },
    8: { intelligence: 4 },
    9: { health: 5 }
  },
  slayer_blaze: {
    1: { health: 3 },
    2: { strength: 1 },
    3: { health: 4 },
    4: { true_defense: 1 },
    5: { health: 5 },
    6: { strength: 2 },
    7: { health: 6 },
    8: { true_defense: 2 },
    9: { health: 7 }
  }
} as Record<string, Record<string, Record<string, number>>>;

export function getBonusStats(level: number, statsBonus: Record<string, { [key: string]: number }>) {
  const bonus = {} as Record<string, number>;
  if (!statsBonus) {
    return bonus;
  }

  const steps = Object.keys(statsBonus)
    .sort((a, b) => Number(a) - Number(b))
    .map((a) => Number(a));

  for (let x = steps[0]; x <= Object.keys(statsBonus).length; x += 1) {
    if (level < x) {
      break;
    }

    const step = Math.max(...steps.filter((a) => a <= x));

    if (step) {
      const stepBonuses = statsBonus[step];

      for (const statName in stepBonuses) {
        bonus[statName] ??= 0;
        bonus[statName] += stepBonuses[statName] ?? 0;
      }
    }
  }

  return Object.fromEntries(Object.entries(bonus).sort(([, a], [, b]) => (b ?? 0) - (a ?? 0)));
}

export function getBonusStat(level: number, key: string, max: number) {
  const bonus = {} as Record<string, number>;
  const objOfLevelBonuses = STATS_BONUS[key];

  if (!objOfLevelBonuses) {
    return bonus;
  }

  const steps = Object.keys(objOfLevelBonuses)
    .sort((a, b) => Number(a) - Number(b))
    .map((a) => Number(a));

  for (let x = steps[0]; x <= max; x += 1) {
    if (level < x) {
      break;
    }

    const step = steps
      .slice()
      .reverse()
      .find((a) => a <= x);

    if (step) {
      const stepBonuses = objOfLevelBonuses[step];

      for (const statNameString in stepBonuses) {
        const statName = statNameString;
        bonus[statName] ??= 0;
        bonus[statName] = (bonus[statName] || 0) + (stepBonuses?.[statName] ?? 0);
      }
    }
  }

  return bonus;
}

export const SYMBOLS = Object.fromEntries(Object.entries(STATS_DATA).map(([key, value]) => [key, value.symbol]));
